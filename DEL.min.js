/**
 * DOM Event Listener
 * @author  RubaXa  <trash@rubaxa.org>
 */
(function(q,f,k){function v(a,b){var c=a.relatedTarget,d=!1;if(c!==b){if(c){do if(c===b){d=!0;break}while((c=c.parentNode)&&c!==j.body)}return!d}return!1}function w(a,b){var c=x.call(arguments,2);if(y!==k)return y.apply(b,[a].concat(c));var d=function(){},e=function(){return b.apply(this instanceof d?this:a||q,c.concat(x.call(arguments)))};d[h]=a[h];e[h]=new d;return e}function m(a){return"string"==typeof a}function z(a,b,c,d){if(a&&1==a.nodeType)if(f)f.event[b?"add":"remove"](a,c,d);else if(a[A])a[b?
A:I](c,d,!1);else a[b?"attachEvent":"detachEvent"]("on"+c,d)}function i(a,b){if(m(a)||a&&1==a.nodeType)a=[a];if("forEach"in a)a.forEach(b);else if("length"in a)for(var c=0,d=a.length;c<d;c++)c in a&&b.call(this,a[c],c);else for(c in a)a.hasOwnProperty(c)&&b.call(this,a[c],c)}function J(a,b){if(b.id!==k)return a.id==b.id;if(b.tag===k||a.tagName==b.tag){if(b.mod!==k){var c=" "+a.className+" ",d=b.mod,e=d.length;if(1===e)return~c.indexOf(" "+d[0]+" ");for(;e--;)if(!~c.indexOf(" "+d[e]+" "))return!1}return!0}return!1}
function B(a){this.type=a.type;this.originalEvent=a;for(var b=e.props.length,c;b--;)c=e.props[b],this[c]=a[c];if(!this.target)this.target=this.srcElement||j;if(3===this.target.nodeType)this.target=this.target.parentNode;if(!this.relatedTarget&&this.fromElement)this.relatedTarget=this.fromElement===this.target?this.toElement:this.fromElement;if(null==this.pageX&&null!=this.clientX)b=this.target.ownerDocument||j,a=b.documentElement,b=b.body,this.pageX=this.clientX+(a&&a.scrollLeft||b&&b.scrollLeft||
0)-(a&&a.clientLeft||b&&b.clientLeft||0),this.pageY=this.clientY+(a&&a.scrollTop||b&&b.scrollTop||0)-(a&&a.clientTop||b&&b.clientTop||0);if(null==this.which&&(null!=this.charCode||null!=this.keyCode))this.which=null!=this.charCode?this.charCode:this.keyCode;if(!this.metaKey&&this.ctrlKey)this.metaKey=this.ctrlKey;if(!this.which&&void 0!==this.button)this.which=this.button&1?1:this.button&2?3:this.button&4?2:0}function s(a,b,c,d){b=b.replace(C,"");d={type:c,fn:d,sel:b,on:!0};if(b.match(K))d.id=RegExp.$1;
else{b=b.split(".");if(b[0]&&"*"!=b[0])d.tag=b[0].toUpperCase();if(1<b.length)d.mod=b.slice(1)}c=e.map[c]||c;(a[c]=a[c]||[]).push(d)}function D(a,b){i(b,function(c,d){"fn"!=d&&(z(a,!1,d,b.fn),c.length&&z(a,!0,d,b.fn))})}function E(a,b,c,d){m(a)&&!c?(d=b,b=a,c="*",a=k):!m(a)&&m(b)&&!d&&(d=c,c="*");b?c&&!d&&(d=c,c=b,b=a,a=k):(b=a,a=k);a=a||j.body;if(m(b)){var l={};l["["+b+"] "+c]=d;b=l}i(a,function(a){var c=a.uniqId||(a.uniqId=++L),d=n[c]=n[c]||{},l;i(b,function(a,b){(l=b.match(F))?(b=b.replace(F,""),
i(e.split(l[1]),function(c){i(b.split(","),function(b){s(d,b,c,a)})})):"[object Object]"==r.call(a)?i(a,function(a,c){i(b.split(","),function(b){i(e.split(c),function(c){s(d,b,c,a)})})}):s(d,b,"click",a)});if(!d.fn)d.fn=function(b){a:{var b=e.fix(b||q.event),d,l,i=b.type,o=b.target,f,g=n[c][i],h;d=b.originalEvent;if(i===G&&!("delta"in b)){if(d.wheelDelta)b.delta=d.wheelDelta/120;if(d.detail)b.delta=-d.detail/3}if(g&&g.length)for(;o!==a;){if(1==o.nodeType)for(d=0,l=g.length;d<l;d++)if(f=g[d],f.on&&
J(o,f)&&(h=e.special[f.type],h===k||h(b,o)))if(b.type=f.type,b.currentTarget=o,!1===f.fn.call(o,b)&&(b.preventDefault(),b.stopPropagation()),b.type=i,b.isPropagationStopped())break a;o=o.parentNode}}};D(a,d)})}function g(a,b,c,d,f){if("[object Boolean]"==r.call(a))var h=f,f=a,a=b,b=c,c=d,d=h;if(m(a))d=c,c=b,b=a,a=j.body;"[object Function]"==r.call(c)||"[object Boolean]"==r.call(d)||c===k?(g(a,b,"",c,f),g(a,"",b,c,f)):i(a,function(a){if(a.uniqId&&n[a.uniqId]){var h=n[a.uniqId],g,j,m;i(h,function(p,
n){if("fn"!==n){for(g=p.length;g--;)j=p[g],i(e.split(b),function(a){if(m=(!a||a==j.type)&&(!d||d===j.fn)&&(!c||c.toLowerCase()==j.sel.toLowerCase()))f!==k?j.on=!f:p=p.slice(0,g).concat(p.slice(g+1))});h[n]=p;D(a,h)}})}})}var K=/#([^\.]+)/i,L=1,n={},h="prototype",x=Array[h].slice,r=Object[h].toString,y=Function[h].bind,M=/(^\s+|\s+$)/g,C=/\s+/g,F=/^\[([^\]]+)\]\s*/i,H=function(){},j=q.document,G="onmousewheel"in j?"mousewheel":"DOMMouseScroll",A="addEventListener",I="removeEventListener",t=function(){return!0},
u=function(){return!1},e={props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(a){return new B(a)},map:{blur:"focusout",focus:"focusin",mouseenter:"mouseover",mouseleave:"mouseout",mousewheel:G},group:{hover:"mouseenter mouseleave",
mouseclick:"mouseup mousedown"},special:{mouseenter:v,mouseleave:v},split:function(a){a=(" "+a+" ").replace(/\s([^\s]+)/,function(a,c){return" "+(e.group[c]||c)});return a.replace(M,"").split(C)},add:function(a,b,c){c?(e.map[a]=b,e.special[a]=c):e.group[a]=b}};B[h]={preventDefault:function(){this.isDefaultPrevented=t;var a=this.originalEvent;a.preventDefault?a.preventDefault():a.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=t;var a=this.originalEvent;a.stopPropagation&&a.stopPropagation();
a.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=t;this.stopPropagation()},isDefaultPrevented:u,isPropagationStopped:u,isImmediatePropagationStopped:u};if(f)e.fix=function(a){return a},e.props=f.event.props,e.special={},f.fn.listen=function(a,b,c){E(this,a,b,c);return this},f.fn.unlisten=function(a,b,c){g(this,a,b,c);return this},f.fn.pauseListen=function(a,b,c){g(this,a,b,c,!0);return this},f.fn.unpauseListen=function(a,b,c){g(this,a,b,c,!1);return this};
q.DEL={on:E,off:g,pause:w(H,g,!0),unpause:w(H,g,!1),event:e}})(this,this.jQuery);
